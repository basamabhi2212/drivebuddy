<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DriveBuddy - Fleet Management</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="page active">
        <div class="login-container">
            <div class="login-header">
                <h1><i class="fas fa-car"></i> DriveBuddy</h1>
                <p>Fleet Management System</p>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="mobileNumber">Mobile Number</label>
                    <input type="tel" id="mobileNumber" required placeholder="Enter your mobile number">
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" required placeholder="Enter your password">
                </div>
                <button type="submit" class="btn btn-primary">Login</button>
            </form>
            <div id="loginError" class="error-message"></div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboardPage" class="page">
        <nav class="navbar">
            <div class="nav-brand">
                <h2><i class="fas fa-car"></i> DriveBuddy</h2>
            </div>
            <div class="nav-user">
                <span id="userRole"></span>
                <button id="logoutBtn" class="btn btn-secondary">Logout</button>
            </div>
        </nav>

        <div class="dashboard-container">
            <aside class="sidebar">
                <ul class="nav-menu">
                    <li><a href="#" data-page="home" class="nav-link active"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#" data-page="trips" class="nav-link"><i class="fas fa-route"></i> Trip Management</a></li>
                    <li><a href="#" data-page="drivers" class="nav-link"><i class="fas fa-users"></i> Driver Management</a></li>
                    <li><a href="#" data-page="reports" class="nav-link"><i class="fas fa-chart-bar"></i> Reports</a></li>
                    <li><a href="#" data-page="estimation" class="nav-link"><i class="fas fa-calculator"></i> Trip Estimation</a></li>
                    <li><a href="#" data-page="finance" class="nav-link"><i class="fas fa-money-bill"></i> Finance</a></li>
                    <li><a href="#" data-page="admin" class="nav-link admin-only"><i class="fas fa-cog"></i> Admin Management</a></li>
                </ul>
            </aside>

            <main class="main-content">
                <!-- Home Page -->
                <div id="homePage" class="content-page active">
                    <div class="page-header">
                        <h2>Dashboard</h2>
                        <button id="bookTripBtn" class="btn btn-primary">Book a Trip</button>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>Active Trips</h3>
                            <p id="activeTrips">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>In-Progress Trips</h3>
                            <p id="inProgressTrips">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Total Drivers</h3>
                            <p id="totalDrivers">0</p>
                        </div>
                    </div>

                    <div class="trip-list">
                        <h3>Recent Trips</h3>
                        <div id="recentTrips" class="trip-cards"></div>
                    </div>
                </div>

                <!-- Trip Management Page -->
                <div id="tripsPage" class="content-page">
                    <div class="page-header">
                        <h2>Trip Management</h2>
                        <button id="addTripBtn" class="btn btn-primary">Add Trip</button>
                    </div>
                    <div id="tripsList" class="trips-grid"></div>
                </div>

                <!-- Driver Management Page -->
                <div id="driversPage" class="content-page">
                    <div class="page-header">
                        <h2>Driver Management</h2>
                        <div class="page-actions">
                            <button id="addDriverBtn" class="btn btn-primary">Add Driver</button>
                            <button id="downloadDriverReportBtn" class="btn btn-secondary">
                                <i class="fas fa-download"></i> Download Report
                            </button>
                        </div>
                    </div>
                    <div id="driversList" class="drivers-grid"></div>
                </div>

                <!-- Reports Page -->
                <div id="reportsPage" class="content-page">
                    <div class="page-header">
                        <h2>Reports</h2>
                        <div class="report-filters">
                            <select id="reportMonth">
                                <option value="">Select Month</option>
                                <option value="1">January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11">November</option>
                                <option value="12">December</option>
                            </select>
                            <select id="reportYear">
                                <option value="">Select Year</option>
                                <option value="2025">2025</option>
                                <option value="2024">2024</option>
                                <option value="2023">2023</option>
                            </select>
                            <button id="generateReportBtn" class="btn btn-secondary">Generate Report</button>
                        </div>
                    </div>
                    <div id="reportsContent" class="reports-table"></div>
                </div>

                <!-- Trip Estimation Page -->
                <div id="estimationPage" class="content-page">
                    <div class="page-header">
                        <h2>Trip Estimation</h2>
                    </div>
                    <div id="estimationContent" class="estimation-container">
                        <div class="estimation-calculator">
                            <h3>Trip Fare Calculator</h3>
                            <div class="calculator-form">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="startTime">Start Time</label>
                                        <input type="time" id="startTime" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="endTime">End Time</label>
                                        <input type="time" id="endTime" required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="tripDate">Trip Date</label>
                                    <input type="date" id="tripDate" required>
                                </div>
                                <div class="form-actions">
                                    <button id="calculateFareBtn" class="btn btn-primary">Calculate Fare</button>
                                    <button id="openEstimationBtn" class="btn btn-secondary">
                                        <i class="fas fa-external-link-alt"></i> Open Dedicated Calculator
                                    </button>
                                </div>
                            </div>
                            <div id="fareResult" class="fare-result" style="display: none;">
                                <h4>Fare Breakdown</h4>
                                <div class="fare-details">
                                    <div class="fare-item">
                                        <span>Total Hours:</span>
                                        <span id="totalHours">0</span>
                                    </div>
                                    <div class="fare-item">
                                        <span>Daytime Hours (7 AM - 10 PM):</span>
                                        <span id="daytimeHours">0</span>
                                    </div>
                                    <div class="fare-item">
                                        <span>Nighttime Hours (10 PM - 7 AM):</span>
                                        <span id="nighttimeHours">0</span>
                                    </div>
                                    <div class="fare-item">
                                        <span>Driver Amount:</span>
                                        <span id="driverAmount">₹0</span>
                                    </div>
                                    <div class="fare-item">
                                        <span>Company Amount:</span>
                                        <span id="companyAmount">₹0</span>
                                    </div>
                                    <div class="fare-item">
                                        <span>Subtotal:</span>
                                        <span id="subtotal">₹0</span>
                                    </div>
                                    <div class="fare-item">
                                        <span>GST (18%):</span>
                                        <span id="gstAmount">₹0</span>
                                    </div>
                                    <div class="fare-item total">
                                        <span><strong>Total Amount:</strong></span>
                                        <span id="totalAmount"><strong>₹0</strong></span>
                                    </div>
                                </div>
                                <div class="pricing-info">
                                    <h5>Pricing Structure:</h5>
                                    <ul>
                                        <li>Daytime (7:00 AM - 10:00 PM): Driver - ₹86/hr, Company - ₹14/hr</li>
                                        <li>Nighttime (10:00 PM - 7:00 AM): Driver - ₹96/hr, Company - ₹14/hr</li>
                                        <li>GST: 18%</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="estimation-iframe">
                            <iframe src="https://basamabhi2212.github.io/drivebuddy/" width="100%" height="400px" frameborder="0" sandbox="allow-scripts allow-same-origin allow-forms allow-popups allow-top-navigation"></iframe>
                        </div>
                    </div>
                </div>

                <!-- Finance Page -->
                <div id="financePage" class="content-page">
                    <div class="page-header">
                        <h2>Finance Management</h2>
                    </div>
                    <div id="financeContent" class="finance-grid"></div>
                </div>

                <!-- Admin Management Page -->
                <div id="adminPage" class="content-page">
                    <div class="page-header">
                        <h2>Admin Management</h2>
                        <button id="addUserBtn" class="btn btn-primary">Add User</button>
                    </div>
                    <div id="usersList" class="users-grid"></div>
                </div>
            </main>
        </div>
    </div>

    <!-- Trip Booking Modal -->
    <div id="tripModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Book a Trip</h3>
                <span class="close">&times;</span>
            </div>
            <form id="tripForm">
                <input type="hidden" id="tripId" name="tripId">
                <div class="form-row">
                    <div class="form-group">
                        <label for="customerName">Customer Name</label>
                        <input type="text" id="customerName" required placeholder="Enter customer name">
                    </div>
                    <div class="form-group">
                        <label for="customerMobile">Customer Mobile</label>
                        <input type="tel" id="customerMobile" required placeholder="Enter mobile number">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="tripStartDate">Trip Start Date</label>
                        <input type="datetime-local" id="tripStartDate" required>
                    </div>
                    <div class="form-group">
                        <label for="tripEndDate">Trip End Date</label>
                        <input type="datetime-local" id="tripEndDate" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="tripType">Trip Type</label>
                        <select id="tripType" required>
                            <option value="">Select Type</option>
                            <option value="in-station">In-Station</option>
                            <option value="out-station">Out-Station</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="routeType">Route Type</label>
                        <select id="routeType" required>
                            <option value="">Select Route</option>
                            <option value="one-way">One-Way</option>
                            <option value="round-trip">Round Trip</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="pickupLocation">Pickup Location</label>
                    <textarea id="pickupLocation" required placeholder="Enter complete pickup address with landmarks"></textarea>
                </div>
                <div class="form-group" id="dropLocationGroup" style="display: none;">
                    <label for="dropLocation">Drop Location</label>
                    <textarea id="dropLocation" placeholder="Enter complete drop address with landmarks"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="vehicleType">Vehicle Type</label>
                        <select id="vehicleType" required>
                            <option value="">Select Vehicle</option>
                            <option value="manual">Manual</option>
                            <option value="automatic">Automatic</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="transmissionType">Transmission Type</label>
                        <select id="transmissionType" required>
                            <option value="">Select Transmission</option>
                            <option value="sedan">Sedan</option>
                            <option value="suv">SUV</option>
                            <option value="luxury">Luxury</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="assignedDriver">Assign Driver (Optional)</label>
                        <select id="assignedDriver">
                            <option value="">No Driver Assigned</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelTripBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="submitTripBtn">Book Trip</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Driver Modal -->
    <div id="driverModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Driver</h3>
                <span class="close">&times;</span>
            </div>
            <form id="driverForm">
                <input type="hidden" id="driverId">
                <div class="form-group">
                    <label for="driverName">Driver Name</label>
                    <input type="text" id="driverName" required placeholder="Enter driver name">
                </div>
                <div class="form-group">
                    <label for="driverMobile">Mobile Number</label>
                    <input type="tel" id="driverMobile" required placeholder="Enter mobile number">
                </div>
                <div class="form-group">
                    <label for="driverLicense">Driving License</label>
                    <input type="text" id="driverLicense" required placeholder="Enter license number">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="licenseIssueDate">License Issue Date</label>
                        <input type="date" id="licenseIssueDate" required>
                    </div>
                    <div class="form-group">
                        <label for="licenseExpiryDate">License Expiry Date</label>
                        <input type="date" id="licenseExpiryDate" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="aadharNumber">Aadhar Number</label>
                    <input type="text" id="aadharNumber" pattern="[0-9]{4}-[0-9]{4}-[0-9]{4}" placeholder="1234-5678-9012" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="bankName">Bank Name</label>
                        <input type="text" id="bankName" required placeholder="Enter bank name">
                    </div>
                    <div class="form-group">
                        <label for="ifscCode">IFSC Code</label>
                        <input type="text" id="ifscCode" pattern="[A-Z]{4}[0-9]{7}" placeholder="SBIN0001234" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="bankDocument">Bank Document (PDF, JPG, PNG) *</label>
                    <input type="file" id="bankDocument" accept=".pdf,.jpg,.jpeg,.png" required>
                </div>
                <div class="form-group">
                    <label for="driverAddress">Address</label>
                    <textarea id="driverAddress" required placeholder="Enter address"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelDriverBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="submitDriverBtn">Add Driver</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Modal -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="userModalTitle">Add User</h3>
                <span class="close">&times;</span>
            </div>
            <form id="userForm">
                <input type="hidden" id="userId">
                <div class="form-group">
                    <label for="userName">User Name</label>
                    <input type="text" id="userName" required placeholder="Enter user name">
                </div>
                <div class="form-group">
                    <label for="userMobile">Mobile Number</label>
                    <input type="tel" id="userMobile" required placeholder="Enter mobile number">
                </div>
                <div class="form-group">
                    <label for="userPassword">Password</label>
                    <input type="password" id="userPassword" required placeholder="Enter password">
                </div>
                <div class="form-group">
                    <label for="userRole">Role</label>
                    <select id="userRole" required>
                        <option value="">Select Role</option>
                        <option value="admin">Admin</option>
                        <option value="executive">Executive</option>
                        <option value="manager">Manager</option>
                        <option value="finance">Finance</option>
                        <option value="driver">Driver</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelUserBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="userSubmitBtn">Add User</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Cancel Trip Modal -->
    <div id="cancelTripModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Cancel Trip</h3>
                <span class="close">&times;</span>
            </div>
            <form id="cancelTripForm">
                <div class="form-group">
                    <label for="tripIdCancel">Trip ID</label>
                    <input type="text" id="tripIdCancel" readonly>
                </div>
                <div class="form-group">
                    <label for="cancellationReason">Reason for Cancellation *</label>
                    <textarea id="cancellationReason" required placeholder="Enter reason for cancellation"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelCancelBtn">Cancel</button>
                    <button type="submit" class="btn btn-danger">Cancel Trip</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Update Payment</h3>
                <span class="close">&times;</span>
            </div>
            <form id="paymentForm">
                <input type="hidden" id="paymentId">
                <div class="form-group">
                    <label for="paymentTripId">Trip ID</label>
                    <input type="text" id="paymentTripId" readonly>
                </div>
                <div class="form-group">
                    <label for="paymentDriverName">Driver Name</label>
                    <input type="text" id="paymentDriverName" readonly>
                </div>
                <div class="form-group">
                    <label for="paymentAmount">Amount</label>
                    <input type="number" id="paymentAmount" required min="0" step="0.01">
                </div>
                <div class="form-group">
                    <label for="paymentMethod">Payment Method</label>
                    <select id="paymentMethod" required>
                        <option value="">Select Payment Method</option>
                        <option value="cash">Cash</option>
                        <option value="phonepe">PhonePe</option>
                        <option value="gpay">GPay</option>
                        <option value="bank_transfer">Bank Transfer</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="paymentStatus">Status</label>
                    <select id="paymentStatus" required>
                        <option value="pending">Pending</option>
                        <option value="paid">Paid</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="paymentDescription">Description</label>
                    <textarea id="paymentDescription" placeholder="Enter payment description"></textarea>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" id="cancelPaymentBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary">Update Payment</button>
                </div>
            </form>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
